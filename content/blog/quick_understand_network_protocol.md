---
title: "Quick understand network protocol"
date: 2020-09-09T11:13:46+08:00
draft: true
---

# 引言

通信是一个古老又现代的词，文学里有暗送秋波，心照不宣，这些都是和别人的一种互动，眼神的信号就是一种通信。
古代长城的建立，每隔几百米就会创建一个烽火台，狼烟起，其他的人就必须响应，因为这意味着匈奴南下。现代的人
都会乘坐地铁这种交通工具，站台工作人员，会使用手势，旗语和调度人员通信，告知其所有车门已经关闭，地铁可以前行了。

一台计算机无法和其他计算机通信的计算机，是一台没有灵魂的计算机。所以计算机也有自己的”旗语“和规则。

# 规则
世界上本来没有路，走的人多了，就有了。当初美帝主义，计算机事业蓬勃发展，IBM, APPLE，MICROSOFT， 纷纷推出自己的网络设备。
每家都有自己的联网规则，随着市面上的各家的设备越来越多，解决他们之间通信的标准，就是迫在眉睫的事情。开完会之后，几家成立了标准委员会
开始制定统一的，屏蔽各个厂商差异的协议，这就是后来的OSI模型（OPEN SYSTEM INTERCONNECTION REFERENCE MODEL）翻译过来是，开放系统互连。


            👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇👇
划重点wiki: __试图使各种计算机在世界范围内互连为网络的标准框架。定義於ISO/IEC 7498-1。__

# OSI分层模型

下图展示了自下向上的分层结构，每一层的关注点都不同，就比如现在建房子是层层依赖一样，地基，楼板，墙，这些都相互独立，层与层之间通过API来沟通。

可以这样说，每一层之间都是不可见，像黑盒子一样，不需要其他层的内部实现，就比如物理层从wifi换成了光纤，并不会影响我们接受消息的格式，字体，颜色等。

那么也就是层和层直接解耦，好处就是各自独立，不会牵一发而动全身，分而治之，各司其职。

另外也屏蔽了各个硬件的差异，只要实现了此参考模型，双方就可以通信。

![](https://ftp.bmp.ovh/imgs/2020/09/c4e7ce65378789e2.jpg)

# TCP/IP参考模型

参见下图中，TCP/IP协议参考模型，它有四层，这是目前网络中常见的分层。

![](https://ftp.bmp.ovh/imgs/2020/09/c4e7ce65378789e2.jpg)

## 应用层
向用户提供一组常用的应用程序，比如QQ, 现在的QQ实现了自己的表示层「基于自有协议数据的编码解码」，实现了自己的登陆，权限控制系统，相当于是会话层
，所以这样的划分也合理。

## 传输层
提供应用程序间的通信。其功能包括：
一、格式化信息流；
二、提供可靠传输。传输层协议规定接收端必须发回确认，并且假如分组丢失，必须重新发送。

## 网络层IP
负责相邻计算机之间的通信。其功能包括三方面。
一、处理来自传输层的分组发送请求，收到请求后，将分组装入IP数据报，填充报头，选择去往信宿机的路径，然后将数据报发往适当的网络接口。

二、处理输入数据报：首先检查其合法性，然后进行寻径--假如该数据报已到达信宿机，则去掉报头，将剩下部分交给适当的传输协议；假如该数据报尚未到达信宿，则转发该数据报。

三、处理路径、流控、拥塞等问题。

## 网络接口层
这是TCP/IP参考模型的最低层，负责接收IP数据报并通过网络发送之，或者从网络上接收物理帧，抽出IP数据报，交给IP层。


# 协议解释

## IP 是无连接的
IP 用于计算机之间的通信。

IP 是无连接的通信协议。它不会占用两个正在通信的计算机之间的通信线路。这样，IP 就降低了对网络线路的需求。每条线可以同时满足许多不同的计算机之间的通信需要。

通过 IP，消息（或者其他数据）被分割为小的独立的包，并通过因特网在计算机之间传送。

IP 负责将每个包路由至它的目的地。

## IP地址
每个计算机必须有一个 IP 地址才能够连入因特网。

每个 IP 包必须有一个地址才能够发送到另一台计算机。

网络上每一个节点都必须有一个独立的Internet地址（也叫做IP地址）。现在，通常使用的IP地址是一个32bit的数字，也就是我们常说的IPv4标准，这32bit的数字分成四组，也就是常见的255.255.255.255的样式。IPv4标准上，地址被分为五类，我们常用的是B类地址。具体的分类请参考其他文档。需要注意的是IP地址是网络号+主机号的组合，这非常重要。

CP/IP 使用 32 个比特来编址。一个计算机字节是 8 比特。所以 TCP/IP 使用了 4 个字节。
一个计算机字节可以包含 256 个不同的值：
00000000、00000001、00000010、00000011、00000100、00000101、00000110、00000111、00001000 ....... 直到 11111111。
现在，你知道了为什么 TCP/IP 地址是介于 0 到 255 之间的 4 个数字。

## TCP 使用固定的连接
TCP 用于应用程序之间的通信。

当应用程序希望通过 TCP 与另一个应用程序通信时，它会发送一个通信请求。这个请求必须被送到一个确切的地址。在双方“握手”之后，TCP 将在两个应用程序之间建立一个全双工 (full-duplex) 的通信。

这个全双工的通信将占用两个计算机之间的通信线路，直到它被一方或双方关闭为止。

UDP 和 TCP 很相似，但是更简单，同时可靠性低于 TCP。

## IP 路由器
当一个 IP 包从一台计算机被发送，它会到达一个 IP 路由器。

IP 路由器负责将这个包路由至它的目的地，直接地或者通过其他的路由器。

在一个相同的通信中，一个包所经由的路径可能会和其他的包不同。而路由器负责根据通信量、网络中的错误或者其他参数来进行正确地寻址。


## 域名
12 个阿拉伯数字很难记忆。使用一个名称更容易。

用于 TCP/IP 地址的名字被称为域名。w3school.com.cn 就是一个域名。

当你键入一个像 http://www.w3school.com.cn 这样的域名，域名会被一种 DNS 程序翻译为数字。

在全世界，数量庞大的 DNS 服务器被连入因特网。DNS 服务器负责将域名翻译为 TCP/IP 地址，同时负责使用新的域名信息更新彼此的系统。

当一个新的域名连同其 TCP/IP 地址一同注册后，全世界的 DNS 服务器都会对此信息进行更新。

## TCP/IP
TCP/IP 意味着 TCP 和 IP 在一起协同工作。

TCP 负责应用软件（比如你的浏览器）和网络软件之间的通信。

IP 负责计算机之间的通信。

TCP 负责将数据分割并装入 IP 包，然后在它们到达的时候重新组合它们。

IP 负责将包发送至接受者。

# 案例分析
不会

# 总结

网络复杂而有趣，更多细节下期再见。





